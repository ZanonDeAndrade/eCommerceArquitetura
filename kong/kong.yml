_format_version: "3.0"
_transform: true

services:
  - name: users-service
    url: http://users-service:3000
    routes:
      - name: users-route
        paths:
          - /users
        strip_path: true
  - name: products-service
    url: http://products-service:3000
    routes:
      - name: products-route
        paths:
          - /products
        strip_path: true
  - name: orders-service
    url: http://order-service:3000
    routes:
      - name: orders-route
        paths:
          - /orders
        strip_path: true
  - name: payments-service
    url: http://payment-service:3000
    routes:
      - name: payments-route
        paths:
          - /payments
        strip_path: true
  - name: ui-service
    url: http://ui-service:3001
    routes:
      - name: ui-route
        paths:
          - /ui
        strip_path: true

plugins:
  - name: rate-limiting
    config:
      minute: 10
      policy: local
      limit_by: ip
  - name: request-size-limiting
    config:
      allowed_payload_size: 1 # ~1MB (closest allowed integer to 200KB constraint)
      require_content_length: false
